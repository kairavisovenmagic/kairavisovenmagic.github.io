this layout is good make phone mandatory "<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Checkout | Kairavi’s Oven Magic</title>
  <link rel="icon" href="images/logo.png"/>
  <link rel="stylesheet" href="style.css?v=14"/>

  <!-- GA4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-4W0YRB7QQ2"></script>
  <script>
    window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}
    gtag('js',new Date()); gtag('config','G-4W0YRB7QQ2');
  </script>

  <!-- Razorpay -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <style>
    /* Compact, clean checkout layout */
    .checkout-grid{display:grid;grid-template-columns:1.5fr 1fr;gap:22px}
    .card{background:#fff;border-radius:14px;box-shadow:0 2px 6px rgba(0,0,0,.06);padding:16px}
    .card h3{margin-bottom:10px}
    .muted{color:#7a5b47}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
    .field{display:flex;flex-direction:column;gap:6px}
    .field input,.field textarea,.field select{padding:10px;border:1px solid #e6dcd5;border-radius:10px;background:#fff;font-size:.95rem}
    .field textarea{min-height:80px;resize:vertical}
    .sum-row{display:flex;justify-content:space-between;margin:8px 0}
    .sum-row.total{font-weight:800}
    .pill{display:inline-block;background:#faf7f3;border:1px solid #e6dcd5;border-radius:999px;padding:6px 10px;font-size:.9rem}
    .cart-table{width:100%;border-collapse:collapse;margin-top:8px}
    .cart-table th,.cart-table td{padding:10px;border-bottom:1px solid #eee;text-align:left}
    .cart-item-thumb{display:flex;gap:10px;align-items:center}
    .cart-item-thumb img{width:48px;height:48px;border-radius:8px;object-fit:cover}
    .mini{font-size:.88rem}
    @media (max-width:980px){.checkout-grid{grid-template-columns:1fr}}
  </style>
</head>
<body>

  <!-- FREE DELIVERY BAR -->
  <div class="freebar">
    FREE delivery over ₹999 • Pune city
    <a href="products.html">Shop more →</a>
  </div>

  <!-- HEADER -->
  <header class="site-header">
    <div class="wrap nav">
      <a class="brand" href="index.html"><img src="images/logo.png" alt="logo"><strong>Kairavi’s Oven Magic</strong></a>
      <nav class="menu">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="contact.html">Contact</a>
        <a href="cart.html" aria-current="page">Cart</a>
        <a id="loginLink" href="login.html">Login</a>
        <a id="logoutLink" href="#" style="display:none">Logout</a>
      </nav>
    </div>
  </header>

  <section class="section">
    <div class="wrap checkout-grid">

      <!-- LEFT: Contact + Delivery + Payment -->
      <div class="card">
        <h3>Contact</h3>
        <div class="field">
          <label class="muted">Email</label>
          <input id="email" type="email" placeholder="you@example.com">
        </div>
        <label class="mini" style="display:flex;gap:8px;align-items:center;margin-top:8px">
          <input id="newsletter" type="checkbox" checked> Keep me up to date on offers by email
        </label>

        <h3 style="margin-top:18px">Delivery</h3>
        <div class="field">
          <label class="muted">Country/Region</label>
          <select id="country"><option value="India">India</option></select>
        </div>
        <div class="row">
          <div class="field"><label class="muted">First name</label><input id="firstName"></div>
          <div class="field"><label class="muted">Last name</label><input id="lastName"></div>
        </div>
        <div class="field">
          <label class="muted">Address</label>
          <input id="address1" placeholder="House, street, area">
        </div>
        <div class="field">
          <label class="muted">Apartment, suite, etc. (optional)</label>
          <input id="address2">
        </div>
        <div class="row-3">
          <div class="field"><label class="muted">City</label><input id="city" value="Pune"></div>
          <div class="field">
            <label class="muted">State</label>
            <select id="state"><option>Maharashtra</option></select>
          </div>
          <div class="field"><label class="muted">PIN code</label><input id="pincode" inputmode="numeric" maxlength="6"></div>
        </div>
        <div class="field">
          <label class="muted">Phone</label>
          <input id="phone" inputmode="tel" placeholder="+91 …">
        </div>
        <label class="mini" style="display:flex;gap:8px;align-items:center;margin-top:8px">
          <input id="saveInfo" type="checkbox"> Save this information for next time
        </label>

        <h3 style="margin-top:18px">Shipping method</h3>
        <div id="shipBox" class="pill">Enter pincode to view shipping methods…</div>

        <h3 style="margin-top:18px">Payment</h3>
        <p class="mini muted">All transactions are secure and encrypted.</p>
        <label class="pill" style="display:flex;gap:8px;align-items:center;margin-top:8px">
          <input type="radio" name="pay" id="payRzp" checked>
          Razorpay Secure (UPI, Cards, Wallets, Netbanking)
        </label>

        <button id="payBtn" class="btn btn-primary" style="margin-top:14px">Pay now</button>
      </div>

      <!-- RIGHT: Order Summary -->
      <aside class="card">
        <h3>Order Summary</h3>
        <table class="cart-table" id="cartTable">
          <thead><tr><th>Item</th><th>Qty</th><th>Total</th></tr></thead>
          <tbody></tbody>
        </table>

        <div class="sum-row"><span>Items</span><span id="itemsCount">0</span></div>
        <div class="sum-row"><span>Subtotal</span><span>₹<span id="subtotal">0</span></span></div>
        <div class="sum-row"><span>Delivery</span><span id="deliveryText">—</span></div>
        <div class="sum-row total"><span>Total</span><span>₹<span id="grandTotal">0</span></span></div>

        <div class="mini muted" style="margin-top:8px">
          Pay online via Razorpay. We’ll confirm your slot on WhatsApp/SMS.
        </div>
      </aside>

    </div>
  </section>

  <footer>
    <div class="wrap footer-grid">
      <div class="small">© 2025 Kairavi’s Oven Magic — Kairavi Food Products</div>
      <div class="small" style="text-align:right">Email: <a href="mailto:kairavisovenmagic@gmail.com">kairavisovenmagic@gmail.com</a></div>
    </div>
  </footer>

  <!-- ========= Checkout Logic ========= -->
  <script>
    /* --------- CONFIG YOU MUST SET --------- */
    const RAZORPAY_KEY_ID   = 'rzp_test_XXXXXXXXXXXX';     // TODO: replace with your Razorpay key id
    const SHIPPING_API_URL  = ''; // e.g. 'https://kom-quote.yourworker.workers.dev/quote'
    const FREE_LIMIT        = 999;

    const CART_KEY='kom_cart';
    const getCart=()=>JSON.parse(localStorage.getItem(CART_KEY)||'[]');
    const setCart=c=>localStorage.setItem(CART_KEY,JSON.stringify(c));

    // UI refs
    const tbody=document.querySelector('#cartTable tbody');
    const itemsCountEl=document.getElementById('itemsCount');
    const subtotalEl=document.getElementById('subtotal');
    const deliveryEl=document.getElementById('deliveryText');
    const grandEl=document.getElementById('grandTotal');
    const payBtn=document.getElementById('payBtn');
    const shipBox=document.getElementById('shipBox');

    const pincodeEl=document.getElementById('pincode');
    const cityEl=document.getElementById('city');
    const stateEl=document.getElementById('state');

    // weight from items (very rough: 250 g = 0.25 kg each)
    function cartWeightKg(cart){
      let w=0;
      cart.forEach(i=>{
        const grams=/(\d+)\s*?g/i.test(i.weight)?(+RegExp.$1):250;
        w+= (grams/1000)*i.qty;
      });
      return Math.max(0.25, +w.toFixed(2));
    }

    function formatINR(n){return (n||0).toLocaleString('en-IN')}

    function guessImage(name){
      const key=(name||'').toLowerCase();
      const map={
        'gulkand':'images/gulkand.jpg','wheat':'images/wheat.jpg','ragi':'images/ragi.jpg','oats':'images/oats.jpg',
        'maize':'images/maize.jpg','jowar':'images/jowar.jpg','upvas':'images/upvas.jpg','chocolate':'images/chocolate.jpg',
        'ajwain sticks':'images/ajwain-sticks.jpg','ajwain cookies':'images/ajwain-cookies.jpg','jeera':'images/jeera.jpg','marble':'images/marble.jpg'
      };
      for(const k in map){ if(key.includes(k)) return map[k] }
      return 'images/wheat.jpg';
    }

    function renderCart(){
      const cart=getCart();
      tbody.innerHTML='';
      let subtotal=0, items=0;
      cart.forEach(r=>{
        const line=r.price*r.qty; items+=r.qty; subtotal+=line;
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td>
            <div class="cart-item-thumb">
              <img src="${guessImage(r.name)}" alt="${r.name}">
              <div><strong>${r.name}</strong><div class="mini muted">${r.weight}</div></div>
            </div>
          </td>
          <td>${r.qty}</td>
          <td>₹${formatINR(line)}</td>`;
        tbody.appendChild(tr);
      });
      itemsCountEl.textContent=items;
      subtotalEl.textContent=formatINR(subtotal);
      return {subtotal, items, weightKg: cartWeightKg(cart)};
    }

    // fallback estimator if API missing/unavailable
    function estimateShipping({subtotal, pincode, weightKg}){
      if(subtotal>=FREE_LIMIT) return 0;
      // simple slabs by weight only (can be tuned)
      const w = Math.ceil(weightKg*4)/4; // quarter-kg steps
      if(!pincode || pincode.length<6) return 79;          // unknown → mid
      if(w<=0.5) return 49;
      if(w<=1.0) return 69;
      if(w<=2.0) return 89;
      return 129 + Math.ceil((w-2)*2)*10; // +₹10 per extra 0.5kg
    }

    async function fetchShippingQuote({pincode, weightKg, subtotal}){
      if(subtotal>=FREE_LIMIT) return 0;
      if(!SHIPPING_API_URL){ return estimateShipping({subtotal,pincode,weightKg}); }
      try{
        const res = await fetch(SHIPPING_API_URL, {
          method:'POST', headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ pincode, weight_kg: weightKg })
        });
        if(!res.ok) throw new Error('quote failed');
        const data = await res.json();               // expect: {amount: number, vendor:'Delhivery'}
        return Math.max(0, Math.round(data.amount));
      }catch(e){
        console.warn('Shipping quote fallback:', e);
        return estimateShipping({subtotal,pincode,weightKg});
      }
    }

    let totals={subtotal:0, delivery:0, grand:0, weightKg:0};
    async function recalc(){
      const snap = renderCart();
      totals.subtotal=snap.subtotal; totals.weightKg=snap.weightKg;

      const pincode = (pincodeEl.value||'').trim();
      shipBox.textContent = pincode && pincode.length===6 ? 'Calculating shipping…' : 'Enter pincode to view shipping methods…';

      const delivery = await fetchShippingQuote({pincode, weightKg: snap.weightKg, subtotal: snap.subtotal});
      totals.delivery = delivery;
      totals.grand = snap.subtotal + delivery;

      deliveryEl.textContent = delivery===0 ? 'FREE' : `₹${formatINR(delivery)}`;
      grandEl.textContent    = formatINR(totals.grand);
      if(pincode && pincode.length===6){
        shipBox.textContent = delivery===0 ? 'Free delivery (order ≥ ₹999)' : `Standard Delivery • ₹${formatINR(delivery)} • via courier`;
      }
      payBtn.disabled = (snap.items===0 || !pincode || pincode.length<6);
      payBtn.style.opacity = payBtn.disabled ? .6 : 1;
    }

    // Recalc on start and when pincode changes
    document.addEventListener('DOMContentLoaded', recalc);
    ['pincode','city','state'].forEach(id=>{
      document.getElementById(id).addEventListener('input', recalc);
      document.getElementById(id).addEventListener('change', recalc);
    });

    // Razorpay pay now
    payBtn.addEventListener('click', ()=>{
      if(payBtn.disabled) return;
      const name = (document.getElementById('firstName').value+' '+document.getElementById('lastName').value).trim() || 'Customer';
      const email= document.getElementById('email').value || 'na@example.com';
      const phone= document.getElementById('phone').value || '9999999999';
      const address = [
        document.getElementById('address1').value,
        document.getElementById('address2').value,
        document.getElementById('city').value,
        document.getElementById('state').value,
        document.getElementById('pincode').value
      ].filter(Boolean).join(', ');

      const options={
        key: RAZORPAY_KEY_ID,
        amount: totals.grand * 100,       // paise
        currency: 'INR',
        name: 'Kairavi’s Oven Magic',
        description: 'Cookie Order',
        prefill: { name, email, contact: phone },
        notes: {
          address,
          weight_kg: String(totals.weightKg),
          shipping_fee: String(totals.delivery),
          subtotal: String(totals.subtotal)
        },
        theme: { color: '#ff7043' },
        handler: function (resp) {
          // Success – clear cart, save order if you want (Firestore), redirect
          localStorage.removeItem(CART_KEY);
          alert('Payment successful! Order ID: '+resp.razorpay_payment_id);
          window.location.href = 'thankyou.html';
        },
        modal: {
          ondismiss: function(){ console.log('Payment modal closed'); }
        }
      };
      const rzp = new Razorpay(options);
      rzp.open();
    });
  </script>

  <!-- Header auth switch -->
  <script type="module">
    import { attachHeaderAuth } from './auth.js?v=14';
    attachHeaderAuth();
  </script>

</body>
</html>
